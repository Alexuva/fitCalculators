<h1>Calculadora de Carbohidratos Keto</h1>

<form class="form-container">
    <p style="margin-bottom: 20px; text-align: center; font-style: italic;">
        Calcula los carbohidratos netos de tu comida o alimento para saber si te mantienes en cetosis.
    </p>

    <div class="flex">
        <div>
            <label><span>Carbohidratos totales (g)</span></label>
            <input type="number" id="carbohidratos" min="0" step="0.1" placeholder="0" required>
        </div>
        <div>
            <label><span>Fibra (g)</span></label>
            <input type="number" id="fibra" min="0" step="0.1" value="0">
        </div>
        <div>
            <label><span>Polialcoholes (eritritol, xilitol, etc.) (g)</span></label>
            <input type="number" id="polialcoholes" min="0" step="0.1" value="0">
        </div>
    </div>

    <button id="calculate-btn" type="submit" value="Calcular" class="btn-calculate">
        Calcular carbohidratos netos
    </button>
</form>

<p class="result" style="visibility: hidden;"></p>

<script type="text/javascript">
    (function() {

        class KetoCalculator {
            _totalCarbs;
            _fiber;
            _sugarAlcohols;

            constructor(totalCarbs, fiber, sugarAlcohols) {
                this._totalCarbs = totalCarbs;
                this._fiber = fiber;
                this._sugarAlcohols = sugarAlcohols;
            }

            get netCarbs() {
                const netCarbs = this._totalCarbs - this._fiber - (this._sugarAlcohols * 0.5);
                return Math.max(0, Math.round(netCarbs * 10) / 10);
            }

            get category() {
                const net = this.netCarbs;

                if (net < 20) {
                    return {
                        name: 'Cetosis profunda',
                        description: 'Te encuentras en cetosis profunda. Ideal para máxima quema de grasa.'
                    };
                } else if (net <= 50) {
                    return {
                        name: 'Zona keto',
                        description: 'Te mantienes en zona cetogénica. La mayoría de personas permanecen en cetosis con este nivel.'
                    };
                } else if (net <= 100) {
                    return {
                        name: 'Salida de cetosis',
                        description: 'Probablemente estés saliendo de cetosis. Considera reducir los carbohidratos.'
                    };
                } else {
                    return {
                        name: 'No cetogénico',
                        description: 'No estás en cetosis con este nivel de carbohidratos netos.'
                    };
                }
            }
        }

        const FORM = document.querySelector('.form-container');
        const RESULT_BOX = document.querySelector('.result');
        const CALCULATE_BTN = document.querySelector('#calculate-btn');

        FORM.addEventListener('submit', (e) => {
            e.preventDefault();

            const totalCarbs = parseFloat(document.getElementById('carbohidratos').value);
            const fiber = parseFloat(document.getElementById('fibra').value) || 0;
            const sugarAlcohols = parseFloat(document.getElementById('polialcoholes').value) || 0;

            if (!totalCarbs && totalCarbs !== 0) {
                alert('Por favor, introduce los carbohidratos totales.');
                return;
            }

            if (totalCarbs < 0 || fiber < 0 || sugarAlcohols < 0) {
                alert('Los valores deben ser mayores o iguales a 0.');
                return;
            }

            CALCULATE_BTN.innerHTML = 'Calculando...';
            RESULT_BOX.style.visibility = 'hidden';

            const calculator = new KetoCalculator(totalCarbs, fiber, sugarAlcohols);
            const netCarbs = calculator.netCarbs;
            const category = calculator.category;

            setTimeout(() => {
                RESULT_BOX.scrollIntoView({ behavior: 'smooth', block: 'center' });
                CALCULATE_BTN.innerHTML = 'Calcular carbohidratos netos';
                RESULT_BOX.style.visibility = 'visible';

                RESULT_BOX.innerHTML = `
                    <span>Carbohidratos netos: <strong>${netCarbs} g</strong></span><br><br>
                    <span><strong>${category.name}</strong></span><br>
                    <span>${category.description}</span>
                `;
            }, 500);
        });

    })();
</script>
