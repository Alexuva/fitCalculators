<form class="form-container">
    <p style="margin-bottom: 20px; text-align: center; font-style: italic;">El burnout es un estado de agotamiento físico y mental causado por el estrés crónico en el trabajo. Responde a este test, basado en la herramienta científica Burnout Assessment Tool (BAT), para evaluar tu nivel de riesgo actual.</p>

    <div class="flex">
        <div>
            <label><span>1. Al final de tu jornada laboral, ¿sientes que no te queda energía para afrontar el resto del día?</span></label>
            <select id="q1" type="select" name="q1-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <div class="flex">
        <div>
            <label><span>2. ¿Te sientes completamente agotado/a por tu trabajo?</span></label>
            <select id="q2" type="select" name="q2-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <div class="flex">
        <div>
            <label><span>3. Cuando te levantas por la mañana, ¿sientes cansancio solo de pensar en tener que ir a trabajar?</span></label>
            <select id="q3" type="select" name="q3-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <div class="flex">
        <div>
            <label><span>4. ¿Sientes una fuerte aversión o falta de entusiasmo por las tareas de tu trabajo?</span></label>
            <select id="q4" type="select" name="q4-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <div class="flex">
        <div>
            <label><span>5. ¿Dudas de si tu trabajo tiene algún significado o utilidad real?</span></label>
            <select id="q5" type="select" name="q5-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <div class="flex">
        <div>
            <label><span>6. ¿Te has vuelto más cínico/a o distante respecto a tu trabajo?</span></label>
            <select id="q6" type="select" name="q6-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <div class="flex">
        <div>
            <label><span>7. ¿Tienes problemas para mantener la concentración en el trabajo?</span></label>
            <select id="q7" type="select" name="q7-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <div class="flex">
        <div>
            <label><span>8. ¿Cometes pequeños errores por descuido que antes no solías cometer?</span></label>
            <select id="q8" type="select" name="q8-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <div class="flex">
        <div>
            <label><span>9. ¿Te cuesta recordar cosas o te sientes mentalmente más lento/a en el trabajo?</span></label>
            <select id="q9" type="select" name="q9-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <div class="flex">
        <div>
            <label><span>10. ¿Reaccionas de forma más irritable o intensa de lo normal ante imprevistos en el trabajo?</span></label>
            <select id="q10" type="select" name="q10-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <div class="flex">
        <div>
            <label><span>11. ¿Te sientes abrumado/a por tus emociones en el trabajo sin saber muy bien por qué?</span></label>
            <select id="q11" type="select" name="q11-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <div class="flex">
        <div>
            <label><span>12. ¿Te sientes frustrado/a o molesto/a por cosas de tu trabajo que antes no te afectaban?</span></label>
            <select id="q12" type="select" name="q12-input" required>
                <option disabled selected>Selecciona</option>
                <option value="0">Nunca o rara vez</option>
                <option value="1">A veces</option>
                <option value="2">A menudo o siempre</option>
            </select>
        </div>
    </div>

    <button id="calculate-btn" type="submit" value="Calcular" class="btn-calculate">
        Ver mi nivel de riesgo
    </button>
</form>

<p class="result" style="visibility: hidden;"></p>

<script type="text/javascript">
    (function() {

        //Inputs de las preguntas
        const Q1 = document.querySelector('#q1');
        const Q2 = document.querySelector('#q2');
        const Q3 = document.querySelector('#q3');
        const Q4 = document.querySelector('#q4');
        const Q5 = document.querySelector('#q5');
        const Q6 = document.querySelector('#q6');
        const Q7 = document.querySelector('#q7');
        const Q8 = document.querySelector('#q8');
        const Q9 = document.querySelector('#q9');
        const Q10 = document.querySelector('#q10');
        const Q11 = document.querySelector('#q11');
        const Q12 = document.querySelector('#q12');

        //Caja con el resultado
        const RESULT_BOX = document.querySelector('.result');

        //Botón de calcular
        const CALCULATE_BTN = document.querySelector('#calculate-btn');

        //Formulario
        const FORM = document.querySelector('.form-container');

        //Comprobar que ha introducido valor en los select
        const SELECTS = document.querySelectorAll('select');
        SELECTS.forEach(select => {
            select.addEventListener('change', () => {
                if (select.value !== "" && select.selectedIndex !== 0) {
                    select.setCustomValidity('');
                }
            });
        });

        FORM.addEventListener('submit', (e)=>{
            e.preventDefault();

            const selects = document.querySelectorAll('select');
            let isValid = true;

            selects.forEach(select => {
                if (select.value === "" || select.selectedIndex === 0) {
                    select.setCustomValidity('Por favor, selecciona una opción');
                    select.reportValidity();
                    isValid = false;
                } else {
                    select.setCustomValidity('');
                }
            });

            if (!isValid) {
                return;
            }

            //Cambiar texto botón
            CALCULATE_BTN.innerHTML = 'Calculando...';

            //Ocultar resultado anterior
            RESULT_BOX.style.visibility = 'hidden';

            // Obtener valores de todas las preguntas
            const q1 = parseInt(Q1.value);
            const q2 = parseInt(Q2.value);
            const q3 = parseInt(Q3.value);
            const q4 = parseInt(Q4.value);
            const q5 = parseInt(Q5.value);
            const q6 = parseInt(Q6.value);
            const q7 = parseInt(Q7.value);
            const q8 = parseInt(Q8.value);
            const q9 = parseInt(Q9.value);
            const q10 = parseInt(Q10.value);
            const q11 = parseInt(Q11.value);
            const q12 = parseInt(Q12.value);

            const CALCULATOR = new BurnoutCalculator(q1, q2, q3, q4, q5, q6, q7, q8, q9, q10, q11, q12);
            const result = CALCULATOR.burnoutRisk;

            setTimeout(()=>{

                //Scroll smooth hasta el resultado
                RESULT_BOX.scrollIntoView({behavior: 'smooth', block: 'center'});

                //Volver a poner el texto en el boton
                CALCULATE_BTN.innerHTML = 'Ver mi nivel de riesgo';

                //Mostrar el resultado
                RESULT_BOX.style.visibility = 'visible';

                let warningMessage = '';
                if (result.showWarning) {
                    warningMessage = '<br><br><span style="font-style: italic;">Sería recomendable que buscaras ayuda profesional.</span>';
                }

                RESULT_BOX.innerHTML = `
                    <span>Tienes un riesgo <strong>${result.level}</strong> de sufrir <i>burnout</i>.</span>${warningMessage}
                `;

            }, 500)

        })

    })();

    class BurnoutCalculator {
        _q1;
        _q2;
        _q3;
        _q4;
        _q5;
        _q6;
        _q7;
        _q8;
        _q9;
        _q10;
        _q11;
        _q12;

        constructor(q1, q2, q3, q4, q5, q6, q7, q8, q9, q10, q11, q12) {
            this._q1 = q1;
            this._q2 = q2;
            this._q3 = q3;
            this._q4 = q4;
            this._q5 = q5;
            this._q6 = q6;
            this._q7 = q7;
            this._q8 = q8;
            this._q9 = q9;
            this._q10 = q10;
            this._q11 = q11;
            this._q12 = q12;
        }

        get burnoutRisk() {
            const totalScore = this._q1 + this._q2 + this._q3 + this._q4 + this._q5 + this._q6 + this._q7 + this._q8 + this._q9 + this._q10 + this._q11 + this._q12;

            let level = '';
            let showWarning = false;

            if (totalScore <= 5) {
                level = 'muy bajo';
            } else if (totalScore >= 6 && totalScore <= 10) {
                level = 'bajo';
            } else if (totalScore >= 11 && totalScore <= 15) {
                level = 'moderado';
            } else if (totalScore >= 16 && totalScore <= 20) {
                level = 'alto';
                showWarning = true;
            } else {
                level = 'muy alto';
                showWarning = true;
            }

            return {
                totalScore,
                level,
                showWarning
            };
        }
    }
</script>
